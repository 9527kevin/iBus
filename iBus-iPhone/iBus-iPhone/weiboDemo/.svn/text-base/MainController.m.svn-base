//
//  MainCtrller.m
//  weiboDemo
//
//  Created by yanghua on 3/22/13.
//  Copyright (c) 2013 yanghua. All rights reserved.
//

#import "MainController.h"

#import "WeiboMainController.h"
#import "AtMsgController.h"
#import "RelationshipSwitchController.h"
#import "DashboardController.h"
#import "MoreFuncListController.h"

@interface MainController ()

@end

@implementation MainController

- (void)dealloc{
    [super dealloc];
    
    [_tabBarCtrller release],_tabBarCtrller=nil;
}

- (id)initWithNibName:(NSString *)nibNameOrNil
               bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)loadView{
    [self layoutSubViews];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma mark - override methods -
- (void)layoutSubViews{
    [super layoutSubViews];
    
    self.view=[[[UIView alloc] initWithFrame:CGRectMake(ZERO_Original_X, ZERO_Original_Y, MainWidth, MainHeight)] autorelease];
    
    self.view.backgroundColor=[UIColor whiteColor];
    
    _tabBarCtrller=[[UITabBarController alloc] init];
    _tabBarCtrller.delegate=self;
    
    
    _tabBarCtrller.viewControllers=[self initViews4TabBarController];
    self.tabBarCtrller.view.frame=TarBarController_View_Frame;
    [self.view addSubview:self.tabBarCtrller.view];
    
    [self configUIAppearance];
    
    [self setTabBarItems4SubViewControllers];
}


- (NSArray*)initViews4TabBarController{
    //home page
    WeiboMainController *weiboMainCtrller=[[[WeiboMainController alloc] initWithRefreshHeaderViewEnabled:YES andLoadMoreFooterViewEnabled:NO andTableViewFrame:Default_TableView_Frame] autorelease];
    UINavigationController *weiboMainNavCtrller=[[[UINavigationController alloc] initWithRootViewController:weiboMainCtrller] autorelease];
    
    weiboMainNavCtrller.tabBarItem=
    [[[UITabBarItem alloc] initWithTitle:@"主页" image:nil tag:0] autorelease];
    
    //message center
    AtMsgController *atMsgCtrller=[[[AtMsgController alloc] init] autorelease];
    UINavigationController *atMsgNavCtrller=[[[UINavigationController alloc] initWithRootViewController:atMsgCtrller] autorelease];
    
    atMsgNavCtrller.tabBarItem=
    [[[UITabBarItem alloc] initWithTitle:@"消息" image:nil tag:1] autorelease];
    
    //relationship
    RelationshipSwitchController *relationshipCtrller=[[[RelationshipSwitchController alloc] init] autorelease];
    UINavigationController *relationshipNavCtrller=[[[UINavigationController alloc] initWithRootViewController:relationshipCtrller] autorelease];
    
    relationshipNavCtrller.tabBarItem=
    [[[UITabBarItem alloc] initWithTitle:@"好友" image:nil tag:2] autorelease];
    
    //square
    DashboardController *dashboardCtrller=[[[DashboardController alloc] init] autorelease];
    UINavigationController *dashboardNavCtrller=[[[UINavigationController alloc] initWithRootViewController:dashboardCtrller] autorelease];

    dashboardNavCtrller.tabBarItem=
    [[[UITabBarItem alloc] initWithTitle:@"广场" image:nil tag:3] autorelease];
    
    //more
    MoreFuncListController *moreFuncListCtrller=[[[MoreFuncListController alloc] init] autorelease];
    UINavigationController *moreFuncListNavCtrller=[[[UINavigationController alloc]initWithRootViewController:moreFuncListCtrller] autorelease];
    
    moreFuncListNavCtrller.tabBarItem=[[[UITabBarItem alloc] initWithTitle:@"更多" image:nil tag:4] autorelease];
    
    return @[weiboMainNavCtrller,
            atMsgNavCtrller,
            relationshipNavCtrller,
            dashboardNavCtrller,
            moreFuncListNavCtrller];
}

#pragma mark - private methods -
-(void)configUIAppearance{
    [[UITabBar appearance] setTintColor:ColorWithRGBA(30, 144, 255, 1)];
    [[UIToolbar appearance] setTintColor:ColorWithRGBA(30, 144, 255, 1)];
    [[UINavigationBar appearance] setTintColor:ColorWithRGBA(30, 144, 255, 1)];
}

- (void)setTabBarItems4SubViewControllers{
    for (UINavigationController *eachNavCtrller in self.tabBarCtrller.viewControllers) {
        if ([eachNavCtrller.tabBarItem respondsToSelector:@selector(setTitleTextAttributes:forState:)]) {
            [eachNavCtrller.tabBarItem setTitleTextAttributes:@{UITextAttributeFont : [UIFont systemFontOfSize:16.0f],UITextAttributeTextColor : [UIColor blackColor] ,UITextAttributeTextShadowColor : [UIColor grayColor]} forState:UIControlStateNormal];
            
        }
    }
}





@end
