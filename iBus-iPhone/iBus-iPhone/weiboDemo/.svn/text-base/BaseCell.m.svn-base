//
//  BaseCell.m
//  weiboDemo
//
//  Created by yanghua on 3/25/13.
//  Copyright (c) 2013 yanghua. All rights reserved.
//

#import "BaseCell.h"

@implementation BaseCell

- (void)dealloc{
    [super dealloc];
    
    [_imageDownloadsInProgress release],_imageDownloadsInProgress=nil;
    [_appImageDownloadCompleted release],_appImageDownloadCompleted=nil;
}

- (id)initWithStyle:(UITableViewCellStyle)style
    reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        // Initialization code
    }
    return self;
}

- (void)setSelected:(BOOL)selected
           animated:(BOOL)animated
{
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
}

#pragma mark - public methods -
- (void)resizeSubviews{
    //waiting for sub class override
}

#pragma mark - download image async -
- (void)startIconDownload:(NSString*)headurl
             forIndexPath:(NSIndexPath *)indexPath
                 withSize:(CGSize)imgSize{
    IconDownloader *headImgDownLoader=[self.imageDownloadsInProgress objectForKey:indexPath];
    
    if (!headImgDownLoader) {
        headImgDownLoader=[[IconDownloader alloc]init];
        headImgDownLoader.imgUrl=headurl;
        headImgDownLoader.imgHeight=imgSize.height;
        headImgDownLoader.imgWidth=imgSize.width;
        headImgDownLoader.indexPathInTableView=indexPath;
        headImgDownLoader.delegate=self;
        [self.imageDownloadsInProgress setObject:headImgDownLoader forKey:indexPath];
        [headImgDownLoader startDownload];
        [headImgDownLoader release];
    }
}

-(void)appImageDidLoad:(NSIndexPath *)indexPath{
    if (self.appImageDownloadCompleted) {
        self.appImageDownloadCompleted(indexPath);
    }
}

@end
